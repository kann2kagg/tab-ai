# Safari浏览器扩展使用指南

## ⚠️ 重要提示

**在Safari中，扩展功能只能通过扩展上下文访问，不能直接打开HTML文件！**

## 正确的使用方法

### 1. 加载扩展到Safari

1. 打开Safari
2. 菜单栏：Safari > 偏好设置 > 高级
3. 勾选"在菜单栏中显示开发菜单"
4. 菜单栏：开发 > 允许未签名扩展
5. 菜单栏：开发 > 显示扩展生成器
6. 点击左下角的 "+" 按钮
7. 选择 `/Users/kann/tab_ai/safari-ai-extension` 文件夹
8. 点击"选择"

### 2. 启用扩展

1. Safari > 偏好设置 > 扩展
2. 找到"AI Browser Assistant"
3. 勾选启用

### 3. 打开设置页面（正确方法）

**方法A：从扩展管理**
1. Safari > 偏好设置 > 扩展
2. 点击"AI Browser Assistant"
3. 点击"扩展设置"按钮

**方法B：右键扩展图标**
1. 在Safari工具栏找到扩展图标（🤖）
2. 右键点击图标
3. 选择"扩展首选项..."

**方法C：从扩展生成器**
1. 开发 > 显示扩展生成器
2. 找到"AI Browser Assistant"
3. 点击"选项"标签

### 4. 配置API

现在你应该能看到设置页面了：

1. 填写API信息：
   ```
   API Base URL: https://api.openai.com/v1
   API Key: sk-你的密钥
   模型: gpt-3.5-turbo
   ```

2. 点击"🔍 测试连接"
   - 如果成功，会显示"✅ 连接成功！"
   - 如果失败，检查API密钥是否正确

3. 点击"💾 保存设置"

## ❌ 错误的使用方法

**不要这样做：**
- ❌ 直接在Finder中双击 `options.html`
- ❌ 直接在Safari中打开 `file:///Users/kann/tab_ai/safari-ai-extension/options.html`
- ❌ 直接打开 `test.html` 进行测试

**为什么不行？**
当你直接打开HTML文件时，它不在扩展上下文中运行，因此：
- `browser.storage` 不可用
- `browser.tabs` 不可用
- `browser.runtime` 功能受限
- 无法与后台脚本通信

## 🔧 常见问题

### Q: 点击"测试连接"没有反应？

**检查清单：**
1. ✅ 是否从扩展设置页面打开？（不是直接打开HTML）
2. ✅ 扩展是否已启用？
3. ✅ 是否允许未签名扩展？
4. ✅ 后台脚本是否运行正常？

**调试步骤：**
1. 右键设置页面 > 检查元素
2. 切换到"控制台"标签
3. 点击"测试连接"
4. 查看控制台输出

### Q: 如何确认扩展正常加载？

1. 打开任意网页
2. 点击工具栏的扩展图标（🤖）
3. 应该能看到弹出窗口

### Q: 扩展图标在哪里？

默认可能不显示在工具栏：
1. Safari > 偏好设置 > 扩展
2. 找到"AI Browser Assistant"
3. 确recognition勾选"在工具栏中显示"

## 💡 开始使用

配置完成后，你可以：

1. **智能标签管理**
   - 点击扩展图标
   - 点击"智能分组"
   
2. **网页摘要**
   - 在任意网页上点击扩展图标
   - 点击"简要摘要"或"详细摘要"

3. **AI助手**
   - 点击"打开AI助手"
   - 在侧边栏与AI对话

## 📞 需要帮助？

如果仍然无法使用：

1. **重启Safari**
2. **重新加载扩展**
   - 开发 > 显示扩展生成器
   - 点击"重新加载"按钮
3. **查看控制台错误**
   - 开发 > 网页检查器
   - 选择"扩展" > "AI Browser Assistant"
   - 查看是否有错误信息

---

记住：**一定要通过扩展设置页面访问，而不是直接打开HTML文件！** 🎯
